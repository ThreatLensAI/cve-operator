# CSYE7125 Helm Chart to deploy CVE Operator

This repository contains Helm chart designed to deploy custom crds `githubreleasemonitor` on Kubernetes cluster.

## Helm Installation

Please follow the installation instructions required for setting up the project [here](INSTALLATION.md).

## Installation

To install the chart with default variables set in `values.yaml`, helm install requires following secrets to be provided.

Following secrets are required:

- `secrets.dockerhubconfigjson` - DockerHub credentials in base64 encoded format.

This can be provided in following two ways:

1. Update the `values.yaml` file variable:

    ```yaml
    secrets:
        dockerhub: <base64 encoded dockerhub config/credentials>
    ```

    and then run the following command:

    ```bash
    helm install cve-operator .
    ```

    This will install the chart with the default values set in `values.yaml` in the `default` namespace.

## Uninstallation

To uninstall the chart, use the following command:

```bash
helm uninstall cve-operator
```

## Configuration

The following table lists the configurable parameters of the chart and their default values.

| Parameter                                                                     | Description                                   | Default                                                                                                  |
| ----------------------------------------------------------------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------- |
| `controllerManager.affinity.enable`                                           | Enable affinity for the controller manager    | `true`                                                                                                   |
| `controllerManager.affinity.topologyKey`                                      | Topology key for affinity                     | `topology.kubernetes.io/zone`                                                                            |
| `controllerManager.manager.initContainers`                                    | Init containers for the manager               | `[]`                                                                                                     |
| `controllerManager.manager.args`                                              | Arguments for the manager                     | `--metrics-bind-address=:8443`, `--leader-elect`, `--health-probe-bind-address=:8081`                    |
| `controllerManager.manager.containerSecurityContext.allowPrivilegeEscalation` | Allow privilege escalation                    | `false`                                                                                                  |
| `controllerManager.manager.containerSecurityContext.capabilities.drop`        | Capabilities to drop                          | `ALL`                                                                                                    |
| `controllerManager.manager.image.repository`                                  | Repository for the manager image              | `marlapativ/cve-operator`                                                                                |
| `controllerManager.manager.image.tag`                                         | Tag for the manager image                     | `latest`                                                                                                 |
| `controllerManager.manager.imagePullPolicy`                                   | Image pull policy for the manager             | `IfNotPresent`                                                                                           |
| `controllerManager.manager.resources.limits.cpu`                              | CPU limit for the manager                     | `500m`                                                                                                   |
| `controllerManager.manager.resources.limits.memory`                           | Memory limit for the manager                  | `128Mi`                                                                                                  |
| `controllerManager.manager.resources.requests.cpu`                            | CPU request for the manager                   | `100m`                                                                                                   |
| `controllerManager.manager.resources.requests.memory`                         | Memory request for the manager                | `64Mi`                                                                                                   |
| `controllerManager.replicas`                                                  | Number of replicas for the controller manager | `1`                                                                                                      |
| `controllerManager.serviceAccount.annotations`                                | Annotations for the service account           | `{}`                                                                                                     |
| `kubernetesClusterDomain`                                                     | Kubernetes cluster domain                     | `cluster.local`                                                                                          |
| `metricsService.ports`                                                        | Ports for the metrics service                 | `name: https`, `port: 8443`, `protocol: TCP`, `targetPort: 8443`                                         |
| `metricsService.type`                                                         | Type of service                               | `ClusterIP`                                                                                              |
| `networkPolicy.ingress`                                                       | Ingress network policies                      | `from: podSelector: {}`                                                                                  |
| `networkPolicy.egress`                                                        | Egress network policies                       | `to: namespaceSelector: matchLabels: kubernetes.io/metadata.name: kafka`, `to: ipBlock: cidr: 0.0.0.0/0` |
